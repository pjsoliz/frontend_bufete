<div class="detail-container">
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando información del cliente...</p>
  </div>

  <div *ngIf="!loading && cliente" class="detail-content">
    <button class="btn-back" (click)="volver()">
      ← Volver a clientes
    </button>

    <div class="detail-header">
      <div class="client-main-info">
        <div class="client-avatar-large">
          {{ cliente.nombre.charAt(0) }}{{ cliente.apellido.charAt(0) }}
        </div>
        <div>
          <h1>{{ cliente.nombre }} {{ cliente.apellido }}</h1>
          <p class="client-email">{{ cliente.email }}</p>
        </div>
      </div>
      <div class="header-actions">
        <span [class]="'badge ' + getEstadoBadgeClass(cliente.estado)">
          {{ getEstadoLabel(cliente.estado) }}
        </span>
        <button class="btn-edit" (click)="editarCliente()">
          ✏️ Editar
        </button>
      </div>
    </div>

    <div class="detail-grid">
      <div class="detail-card">
        <h2>📋 Información Personal</h2>
        <div class="detail-item">
          <span class="label">Nombre Completo:</span>
          <span class="value">{{ cliente.nombre }} {{ cliente.apellido }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Correo Electrónico:</span>
          <span class="value">{{ cliente.email }}</span>
        </div>
        <div class="detail-item" *ngIf="cliente.telefono">
          <span class="label">Teléfono:</span>
          <span class="value">{{ cliente.telefono }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Fecha de Registro:</span>
          <span class="value">{{ cliente.fecha_registro | date:'dd/MM/yyyy' }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Estado:</span>
          <span class="value">
            <span [class]="'badge ' + getEstadoBadgeClass(cliente.estado)">
              {{ getEstadoLabel(cliente.estado) }}
            </span>
          </span>
        </div>
      </div>

      <div class="detail-card">
  <h2>📊 Estadísticas</h2>
  <div class="stats-grid">
    <div class="stat-box">
      <div class="stat-number">{{ casos.length }}</div>
      <div class="stat-label">Casos Totales</div>
    </div>
    <div class="stat-box">
      <div class="stat-number">{{ citas.length }}</div>
      <div class="stat-label">Citas Totales</div>
    </div>
    <div class="stat-box">
      <div class="stat-number">{{ getCasosActivos() }}</div>
      <div class="stat-label">Casos Activos</div>
    </div>
    <div class="stat-box">
      <div class="stat-number">{{ getCitasPendientes() }}</div>
      <div class="stat-label">Citas Pendientes</div>
    </div>
  </div>
</div>

    <div class="detail-card full-width">
      <h2>📁 Casos del Cliente</h2>
      <div *ngIf="casos.length === 0" class="empty-message">
        No hay casos registrados para este cliente
      </div>
      <div *ngIf="casos.length > 0" class="list-items">
        <div *ngFor="let caso of casos" class="list-item">
          <div class="item-header">
            <h4>{{ caso.titulo }}</h4>
            <span [class]="'badge ' + getCasoBadgeClass(caso.estado)">
              {{ caso.estado }}
            </span>
          </div>
          <p class="item-description">{{ caso.descripcion }}</p>
          <div class="item-footer">
            <span class="item-meta">📅 {{ caso.fecha_apertura | date:'dd/MM/yyyy' }}</span>
            <span class="item-meta">📋 {{ caso.tipo_caso }}</span>
            <a [routerLink]="['/casos', caso.id]" class="link-btn">Ver detalle →</a>
          </div>
        </div>
      </div>
    </div>

    <div class="detail-card full-width">
      <h2>📅 Citas del Cliente</h2>
      <div *ngIf="citas.length === 0" class="empty-message">
        No hay citas registradas para este cliente
      </div>
      <div *ngIf="citas.length > 0" class="list-items">
        <div *ngFor="let cita of citas" class="list-item">
          <div class="item-header">
            <h4>{{ cita.tipo_cita }}</h4>
            <span [class]="'badge ' + getCitaBadgeClass(cita.estado)">
              {{ cita.estado }}
            </span>
          </div>
          <div class="item-info">
            <p><strong>📅</strong> {{ cita.fecha_hora | date:'dd/MM/yyyy HH:mm' }}</p>
            <p><strong>⏱️</strong> {{ cita.duracion_minutos }} minutos</p>
            <p><strong>📍</strong> {{ cita.modalidad }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
