<div class="detalle-container">
  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando cliente...</p>
  </div>

  <!-- Error -->
  <div *ngIf="!loading && errorMessage" class="error-container">
    <i-lucide name="alert-triangle" class="error-icon" [size]="64"></i-lucide>
    <h2>{{ errorMessage }}</h2>
    <button class="btn-primary" (click)="volver()">
      <i-lucide name="arrow-left" [size]="18"></i-lucide>
      Volver a Clientes
    </button>
  </div>

  <!-- Detalle del Cliente -->
  <div *ngIf="!loading && cliente" class="detalle-content">

    <!-- Header -->
    <div class="detalle-header">
      <button class="btn-back" (click)="volver()">
        <i-lucide name="arrow-left" [size]="18"></i-lucide>
        Volver
      </button>

      <div class="header-main">
        <div class="header-left">
          <div class="cliente-avatar-large">
            {{ getIniciales() }}
          </div>
          <div class="cliente-info-header">
            <h1>{{ cliente.nombreCompleto }}</h1>
            <div class="badges-row">
              <span class="badge-plataforma" [ngClass]="getPlataformaClass(cliente.plataforma)">
                <span class="plataforma-icon">{{ getPlataformaIcon(cliente.plataforma) }}</span>
                {{ getPlataformaTexto(cliente.plataforma) }}
              </span>
              <span class="badge-id">
                <i-lucide name="hash" [size]="14"></i-lucide>
                ID: {{ getClienteIdCorto() }}
              </span>
            </div>
          </div>
        </div>

        <div class="header-right">
          <button class="btn-action btn-edit" (click)="editarCliente()">
            <i-lucide name="edit" [size]="18"></i-lucide>
            Editar
          </button>
          <button class="btn-action btn-delete" (click)="eliminarCliente()">
            <i-lucide name="trash-2" [size]="18"></i-lucide>
            Eliminar
          </button>
        </div>
      </div>
    </div>

    <!-- Content Grid -->
    <div class="content-grid">

      <!-- Columna Principal -->
      <div class="main-column">

        <!-- Información de Contacto -->
        <div class="info-card">
          <h2>
            <i-lucide name="phone" [size]="20"></i-lucide>
            Información de Contacto
          </h2>

          <div class="info-grid">
            <!-- Teléfono -->
            <div class="info-item">
              <div class="info-label">
                <i-lucide name="smartphone" [size]="16"></i-lucide>
                Teléfono
              </div>
              <div class="info-value">
                <span class="info-text">{{ formatearTelefono(cliente.telefono) }}</span>
                <div class="info-actions">
                  <button 
                    class="btn-icon" 
                    (click)="enviarWhatsApp()"
                    title="Enviar WhatsApp">
                    <i-lucide name="phone" [size]="16"></i-lucide>
                  </button>
                  <button 
                    class="btn-icon" 
                    (click)="copiarAlPortapapeles(cliente.telefono, 'Teléfono')"
                    title="Copiar teléfono">
                    <i-lucide name="file" [size]="16"></i-lucide>
                  </button>
                </div>
              </div>
            </div>

            <!-- Email -->
            <div class="info-item" *ngIf="cliente.email">
              <div class="info-label">
                <i-lucide name="mail" [size]="16"></i-lucide>
                Email
              </div>
              <div class="info-value">
                <span class="info-text">{{ cliente.email }}</span>
                <div class="info-actions">
                  <button 
                    class="btn-icon" 
                    (click)="enviarEmail()"
                    title="Enviar email">
                    <i-lucide name="mail" [size]="16"></i-lucide>
                  </button>
                  <button 
                    class="btn-icon" 
                    (click)="copiarAlPortapapeles(cliente.email, 'Email')"
                    title="Copiar email">
                    <i-lucide name="file" [size]="16"></i-lucide>
                  </button>
                </div>
              </div>
            </div>

            <!-- Sin Email -->
            <div class="info-item" *ngIf="!cliente.email">
              <div class="info-label">
                <i-lucide name="mail" [size]="16"></i-lucide>
                Email
              </div>
              <div class="info-value">
                <span class="sin-dato">No proporcionado</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Información de Plataforma -->
        <div class="info-card">
          <h2>
            <i-lucide name="smartphone" [size]="20"></i-lucide>
            Información de Plataforma
          </h2>

          <div class="info-grid">
            <!-- Plataforma -->
            <div class="info-item">
              <div class="info-label">
                <i-lucide name="globe" [size]="16"></i-lucide>
                Plataforma de Contacto
              </div>
              <div class="info-value">
                <span class="badge-plataforma" [ngClass]="getPlataformaClass(cliente.plataforma)">
                  <span class="plataforma-icon">{{ getPlataformaIcon(cliente.plataforma) }}</span>
                  {{ getPlataformaTexto(cliente.plataforma) }}
                </span>
              </div>
            </div>

            <!-- ID en Plataforma -->
            <div class="info-item" *ngIf="cliente.userIdPlataforma">
              <div class="info-label">
                <i-lucide name="hash" [size]="16"></i-lucide>
                ID en {{ getPlataformaTexto(cliente.plataforma) }}
              </div>
              <div class="info-value">
                <span class="info-text">{{ cliente.userIdPlataforma }}</span>
                <button 
                  class="btn-icon" 
                  (click)="copiarAlPortapapeles(cliente.userIdPlataforma, 'ID de plataforma')"
                  title="Copiar ID">
                  <i-lucide name="file" [size]="16"></i-lucide>
                </button>
              </div>
            </div>

            <!-- Sin ID -->
            <div class="info-item" *ngIf="!cliente.userIdPlataforma">
              <div class="info-label">
                <i-lucide name="hash" [size]="16"></i-lucide>
                ID en Plataforma
              </div>
              <div class="info-value">
                <span class="sin-dato">No proporcionado</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Información del Sistema -->
        <div class="info-card">
          <h2>
            <i-lucide name="info" [size]="20"></i-lucide>
            Información del Sistema
          </h2>

          <div class="info-grid">
            <!-- ID Completo -->
            <div class="info-item full-width">
              <div class="info-label">
                <i-lucide name="hash" [size]="16"></i-lucide>
                ID del Cliente
              </div>
              <div class="info-value">
                <span class="info-text id-completo">{{ cliente.id }}</span>
                <button 
                  class="btn-icon" 
                  (click)="copiarAlPortapapeles(cliente.id, 'ID del cliente')"
                  title="Copiar ID">
                  <i-lucide name="file" [size]="16"></i-lucide>
                </button>
              </div>
            </div>

            <!-- Fecha de Creación -->
            <div class="info-item">
              <div class="info-label">
                <i-lucide name="calendar" [size]="16"></i-lucide>
                Fecha de Registro
              </div>
              <div class="info-value">
                <span class="info-text">{{ formatearFechaCorta(cliente.createdAt) }}</span>
              </div>
            </div>

            <!-- Última Actualización -->
            <div class="info-item" *ngIf="cliente.updatedAt">
              <div class="info-label">
                <i-lucide name="calendar" [size]="16"></i-lucide>
                Última Actualización
              </div>
              <div class="info-value">
                <span class="info-text">{{ formatearFechaCorta(cliente.updatedAt) }}</span>
              </div>
            </div>
          </div>
        </div>

      </div>

    </div>

  </div>
</div>