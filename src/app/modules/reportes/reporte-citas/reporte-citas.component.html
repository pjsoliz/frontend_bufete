<div class="reporte-container">
  <!-- Header -->
  <div class="reporte-header">
    <button class="btn-back" routerLink="/reportes">← Volver</button>
    <h1>📅 Reporte de Citas</h1>
    <p>Análisis de citas programadas, completadas y por abogado</p>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando datos...</p>
  </div>

  <!-- Content -->
  <div *ngIf="!loading && datos" class="reporte-content">
    
    <!-- Resumen Cards -->
    <div class="summary-cards">
      <div class="summary-card blue">
        <div class="summary-icon">📊</div>
        <div class="summary-info">
          <h3>{{ datos.total }}</h3>
          <p>Total de Citas</p>
        </div>
      </div>

      <div class="summary-card orange">
        <div class="summary-icon">📅</div>
        <div class="summary-info">
          <h3>{{ datos.por_estado.programada }}</h3>
          <p>Programadas</p>
        </div>
      </div>

      <div class="summary-card green">
        <div class="summary-icon">✅</div>
        <div class="summary-info">
          <h3>{{ datos.por_estado.completada }}</h3>
          <p>Completadas</p>
        </div>
      </div>

      <div class="summary-card purple">
        <div class="summary-icon">📈</div>
        <div class="summary-info">
          <h3>{{ datos.tasa_asistencia }}%</h3>
          <p>Tasa de Asistencia</p>
        </div>
      </div>
    </div>

    <!-- Gráficas Grid -->
    <div class="charts-grid">
      
      <!-- Gráfica por Estado -->
      <div class="chart-card">
        <div class="chart-wrapper">
          <canvas id="chartEstadoCitas"></canvas>
        </div>
      </div>

      <!-- Gráfica Mensual -->
      <div class="chart-card">
        <div class="chart-wrapper">
          <canvas id="chartMensualCitas"></canvas>
        </div>
      </div>

      <!-- Gráfica por Abogados - Ancho Completo -->
      <div class="chart-card chart-card-wide">
        <div class="chart-wrapper-wide">
          <canvas id="chartAbogados"></canvas>
        </div>
      </div>

    </div>

    <!-- Tabla de Abogados -->
    <div class="tabla-abogados">
      <h2>📋 Detalle por Abogado</h2>
      <table>
        <thead>
          <tr>
            <th>Abogado</th>
            <th>Citas Atendidas</th>
            <th>Porcentaje</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let abogado of datos.por_abogado">
            <td>{{ abogado.nombre }}</td>
            <td>{{ abogado.cantidad }}</td>
            <td>{{ ((abogado.cantidad / datos.total) * 100).toFixed(1) }}%</td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>