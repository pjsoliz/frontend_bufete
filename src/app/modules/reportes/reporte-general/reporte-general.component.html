<div class="reporte-container">
  <!-- Header -->
  <div class="reporte-header">
    <button class="btn-back" routerLink="/reportes">← Volver</button>
    <h1>📊 Reporte General</h1>
    <p>Vista completa del sistema con métricas clave y resumen ejecutivo</p>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando datos...</p>
  </div>

  <!-- Content -->
  <div *ngIf="!loading && datos" class="reporte-content">
    
    <!-- KPIs Principales -->
    <div class="kpi-section">
      <h2>🎯 Indicadores Clave</h2>
      
      <div class="kpi-grid">
        <div class="kpi-card blue">
          <div class="kpi-icon">📁</div>
          <div class="kpi-content">
            <div class="kpi-value">{{ datos.resumen.total_casos }}</div>
            <div class="kpi-label">Casos Totales</div>
            <div class="kpi-badge positive">+12% este mes</div>
          </div>
        </div>

        <div class="kpi-card green">
          <div class="kpi-icon">📅</div>
          <div class="kpi-content">
            <div class="kpi-value">{{ datos.resumen.total_citas }}</div>
            <div class="kpi-label">Citas Programadas</div>
            <div class="kpi-badge positive">+8% este mes</div>
          </div>
        </div>

        <div class="kpi-card purple">
          <div class="kpi-icon">👥</div>
          <div class="kpi-content">
            <div class="kpi-value">{{ datos.resumen.total_clientes }}</div>
            <div class="kpi-label">Clientes Activos</div>
            <div class="kpi-badge positive">+15% este mes</div>
          </div>
        </div>

        <div class="kpi-card orange">
          <div class="kpi-icon">⚖️</div>
          <div class="kpi-content">
            <div class="kpi-value">{{ datos.resumen.total_abogados }}</div>
            <div class="kpi-label">Abogados</div>
            <div class="kpi-badge neutral">Estable</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Resumen Financiero -->
    <div class="financiero-section">
      <h2>💰 Resumen Financiero</h2>
      
      <div class="financiero-cards">
        <div class="financiero-card ingresos">
          <div class="financiero-header">
            <span class="financiero-icon">💵</span>
            <span class="financiero-title">Ingresos</span>
          </div>
          <div class="financiero-value">${{ datos.ingresos_mes.toLocaleString() }}</div>
          <div class="financiero-subtitle">Este mes</div>
        </div>

        <div class="financiero-card gastos">
          <div class="financiero-header">
            <span class="financiero-icon">💸</span>
            <span class="financiero-title">Gastos</span>
          </div>
          <div class="financiero-value">${{ datos.gastos_mes.toLocaleString() }}</div>
          <div class="financiero-subtitle">Este mes</div>
        </div>

        <div class="financiero-card utilidad">
          <div class="financiero-header">
            <span class="financiero-icon">💎</span>
            <span class="financiero-title">Utilidad</span>
          </div>
          <div class="financiero-value">${{ datos.utilidad_mes.toLocaleString() }}</div>
          <div class="financiero-subtitle">Este mes</div>
        </div>
      </div>
    </div>

    <!-- Gráficas -->
    <div class="charts-section">
      <div class="chart-card">
        <div class="chart-wrapper">
          <canvas id="chartFinanciero"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-wrapper">
          <canvas id="chartResultados"></canvas>
        </div>
      </div>
    </div>

    <!-- Tasa de Éxito -->
    <div class="exito-section">
      <h2>🏆 Desempeño Legal</h2>
      
      <div class="exito-grid">
        <div class="exito-card ganados">
          <div class="exito-number">{{ datos.casos_ganados }}</div>
          <div class="exito-label">Casos Ganados</div>
          <div class="exito-icon">✅</div>
        </div>

        <div class="exito-card perdidos">
          <div class="exito-number">{{ datos.casos_perdidos }}</div>
          <div class="exito-label">Casos Perdidos</div>
          <div class="exito-icon">❌</div>
        </div>

        <div class="exito-card-large tasa">
          <div class="tasa-content">
            <div class="tasa-porcentaje">{{ datos.tasa_exito }}%</div>
            <div class="tasa-label">Tasa de Éxito</div>
            <div class="tasa-descripcion">Excelente desempeño del equipo legal</div>
          </div>
          <div class="tasa-icon">🎯</div>
        </div>
      </div>
    </div>

    <!-- Resumen por Área -->
    <div class="areas-section">
      <h2>📋 Resumen por Área</h2>
      
      <div class="areas-table">
        <table>
          <thead>
            <tr>
              <th>Área</th>
              <th>Cantidad</th>
              <th>Estado</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <span class="area-icon">📁</span>
                <span>Casos Totales</span>
              </td>
              <td><strong>{{ datos.resumen.total_casos }}</strong></td>
              <td><span class="badge badge-blue">Activo</span></td>
            </tr>
            <tr>
              <td>
                <span class="area-icon">📅</span>
                <span>Citas Programadas</span>
              </td>
              <td><strong>{{ datos.resumen.total_citas }}</strong></td>
              <td><span class="badge badge-green">En Progreso</span></td>
            </tr>
            <tr>
              <td>
                <span class="area-icon">👥</span>
                <span>Clientes Activos</span>
              </td>
              <td><strong>{{ datos.resumen.total_clientes }}</strong></td>
              <td><span class="badge badge-purple">Creciendo</span></td>
            </tr>
            <tr>
              <td>
                <span class="area-icon">⚖️</span>
                <span>Equipo Legal</span>
              </td>
              <td><strong>{{ datos.resumen.total_abogados }}</strong></td>
              <td><span class="badge badge-orange">Completo</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>